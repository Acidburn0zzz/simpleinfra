---

# This Travis CI snippet is used to deploy static websites hosted on GitHub
# Pages and managed by the Rust Infrastructure team.

before_deploy:
  - |
    if [[ -z "${RUSTINFRA_DEPLOY_DIR+x}" ]]; then
        echo "Environment variable RUSTINFRA_DEPLOY_DIR is not set!"
        return 1
    fi
  # Ensure GitHub doesn't mess around with the uploaded file.
  # Without the file, for example, files with an underscore in the name won't
  # be included in the pages.
  - touch $RUSTINFRA_DEPLOY_DIR/.nojekyll

# Deploy the content of $RUSTINFRA_DEPLOY_DIR to GitHub Pages using deploy keys.
deploy:
  provider: script
  script: curl -LsSf https://git.io/fhJ8n | rustc - -o /tmp/deploy && (cd $RUSTINFRA_DEPLOY_DIR && /tmp/deploy)
  skip_cleanup: true
  on:
    branch: master
